<div ng-if="loginCtrl.isLoading" class="d-flex justify-content-center">
  <div class="spinner-border" role="status">
    <span class="sr-only">Loading...</span>
  </div>
</div>

<div ng-if="loginCtrl.showLogin()" class="row">
  <div class="col-md-6 offset-md-3 login-form">
    <h2 class="text-center">Iniciar sesión</h2>
    <form name="formLogin" ng-submit="loginCtrl.submit()">
      <div class="form-group">
        <label for="email">Correo:</label>
        <input type="email" class="form-control" id="email" name="email" ng-model="loginCtrl.userModel.email"
          placeholder="Correo" required>
        <small class="text-danger"
          ng-if="formLogin.email.$error.required && (formLogin.email.$touched || formLogin.email.$dirty || formLogin.$submitted)">
          Debe ingresar el correo.
        </small>
        <small class="text-danger"
          ng-if="formLogin.email.$error.email && (formLogin.email.$touched || formLogin.email.$dirty || formLogin.$submitted)">
          Ingrese un correo válido.
        </small>
      </div>
      <div class="form-group">
        <label for="password">Contraseña:</label>
        <input type="password" class="form-control" id="password" name="password"
          ng-model="loginCtrl.userModel.password" placeholder="Contraseña" required>
        <small class="text-danger"
          ng-if="formLogin.password.$error.required && (formLogin.password.$touched || formLogin.password.$dirty || formLogin.$submitted)">
          Debe ingresar la contraseña.
        </small>
      </div>
      <button type="submit" class="btn btn-primary btn-block" ng-disabled="formLogin.$invalid">Aceptar</button>
      <div class="form-group"
        style="display: flex; flex-direction: row; justify-content: space-evenly; margin-top: 2rem;">
        <a ng-click="loginCtrl.show(1)" style="cursor: pointer;">Crear cuenta</a>
      </div>
    </form>
  </div>
</div>

<div ng-if="loginCtrl.showHome()" class="row">
  <h2>Bienvenido</h2>
  <hr>
  <h4>Correo: {{loginCtrl.session.email}}</h4>
  <h4>Último logueo: {{loginCtrl.session.lastLogin | date:'dd-MM-yyyy HH:mm a'}} </h4>
  <h4>Cambio contraseña: {{loginCtrl.session.datePassword | date:'dd-MM-yyyy HH:mm a'}} </h4>
  <hr>
  <div style="display: flex; flex-direction: row; justify-content: flex-start; align-items: center;">
    <h4 style="margin-right: 1rem;"> Contraseña: </h4> <button type="button" class="btn btn-primary btn-block" style="width: 8rem;" ng-click="loginCtrl.open()">Cambiar</button> 
  </div>
</div>

<!-- seccion para crear cuenta -->

<div ng-if="loginCtrl.showSignUp()" class="row">
  <div class="col-md-6 offset-md-3 login-form">
    <h2 class="text-center">Crear cuenta</h2>
    <form name="formSignup" ng-submit="loginCtrl.submit()">
      <div class="form-group">
        <label for="email">Correo:</label>
        <input type="email" class="form-control" id="email" name="email" ng-model="loginCtrl.userModel.email"
          placeholder="Correo" required>
        <small class="text-danger"
          ng-if="formSignup.email.$error.required && (formSignup.email.$touched || formSignup.email.$dirty || formSignup.$submitted)">
          Debe ingresar el correo.
        </small>
        <small class="text-danger"
          ng-if="formSignup.email.$error.email && (formSignup.email.$touched || formSignup.email.$dirty || formSignup.$submitted)">
          Ingrese un correo válido.
        </small>
      </div>
      <div class="form-group">
        <label for="password">Contraseña:</label>
        <input type="password" class="form-control" id="password" name="password" ng-minlength="8"
          ng-model="loginCtrl.userModel.password" placeholder="Contraseña" required>
        <small class="text-danger"
          ng-if="formSignup.password.$error.required && (formSignup.password.$touched || formSignup.password.$dirty || formSignup.$submitted)">
          Debe ingresar la contraseña.
        </small>
        <small class="text-danger"
          ng-if="formSignup.password.$error.minlength && (formSignup.password.$touched || formSignup.password.$dirty || formSignup.$submitted)">
          La contraseña debe tener mínimo 8 caracteres.
        </small>
      </div>
      <div class="form-group">
        <label for="confirm">Confirmar contraseña:</label>
        <input type="password" class="form-control" id="confirm" name="confirm" ng-model="loginCtrl.confirm"
          ng-minlength="8" placeholder="Contraseña" required>
        <small class="text-danger"
          ng-if="formSignup.confirm.$error.required && (formSignup.confirm.$touched || formSignup.confirm.$dirty || formSignup.$submitted)">
          Debe confirmar la contraseña.
        </small>
        <small class="text-danger"
          ng-if="!formSignup.confirm.$error.required && !loginCtrl.isConfirm() && (formSignup.confirm.$touched || formSignup.confirm.$dirty || formSignup.$submitted)">
          Las contraseñas no coinciden.
        </small>
      </div>
      <button type="submit" class="btn btn-primary btn-block" ng-disabled="!loginCtrl.isValidSignup()">Aceptar</button>
      <div class="form-group"
        style="display: flex; flex-direction: row; justify-content: space-evenly; margin-top: 2rem;">
        <a ng-click="loginCtrl.show(0)" style="cursor: pointer;">Iniciar sesión</a>
      </div>
    </form>
  </div>
</div>

<!-- Change password -->

<div ng-if="loginCtrl.showReset()" class="row">
  <div class="col-md-6 offset-md-3 login-form">
    <h2 class="text-center">Cambiar contraseña</h2>
    <form name="formReset" ng-submit="loginCtrl.submit()">
      <div class="form-group">
        <label for="oldPassword">Contraseña anterior:</label>
        <input type="password" class="form-control" id="oldPassword" name="oldPassword" ng-minlength="8"
          ng-model="loginCtrl.userModel.oldPassword" placeholder="Contraseña anterior" required>
        <small class="text-danger"
          ng-if="formReset.oldPassword.$error.required && (formReset.oldPassword.$touched || formReset.oldPassword.$dirty || formReset.$submitted)">
          Debe ingresar la contraseña.
        </small>
        <small class="text-danger"
          ng-if="formReset.oldPassword.$error.minlength && (formReset.oldPassword.$touched || formReset.oldPassword.$dirty || formReset.$submitted)">
          La contraseña debe tener mínimo 8 caracteres.
        </small>
      </div>
      <div class="form-group">
        <label for="password">Contraseña:</label>
        <input type="password" class="form-control" id="password" name="password" ng-minlength="8"
          ng-model="loginCtrl.userModel.password" placeholder="Contraseña" required>
        <small class="text-danger"
          ng-if="formReset.password.$error.required && (formReset.password.$touched || formReset.password.$dirty || formReset.$submitted)">
          Debe ingresar la contraseña.
        </small>
        <small class="text-danger"
          ng-if="formReset.password.$error.minlength && (formReset.password.$touched || formReset.password.$dirty || formReset.$submitted)">
          La contraseña debe tener mínimo 8 caracteres.
        </small>
      </div>
      <div class="form-group">
        <label for="confirm">Confirmar Contraseña:</label>
        <input type="password" class="form-control" id="confirm" name="confirm" ng-model="loginCtrl.confirm"
          ng-minlength="8" placeholder="Contraseña" required>
        <small class="text-danger"
          ng-if="formReset.confirm.$error.required && (formReset.confirm.$touched || formReset.confirm.$dirty || formReset.$submitted)">
          Debe confirmar la contraseña.
        </small>
        <small class="text-danger"
          ng-if="!formReset.confirm.$error.required && !loginCtrl.isConfirm() && (formReset.confirm.$touched || formReset.confirm.$dirty || formReset.$submitted)">
          Las contraseñas no coinciden.
        </small>
      </div>
      <button type="submit" class="btn btn-primary btn-block" ng-disabled="!loginCtrl.isValidReset()">Aceptar</button>
    </form>
  </div>
</div>